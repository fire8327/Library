<template>
    <div class="flex flex-col gap-6 w-full rounded-xl py-12 px-6 bg-gradient-to-r from-yellow-500 to-amber-600 text-white h-fit">
        <p class="text-3xl font-semibold font-mono">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Ü–∏—Ñ—Ä–æ–≤—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É!</p>
        <p class="text-xl">–û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤—É—é –ª—é–±–∏–º—É—é –∫–Ω–∏–≥—É —Å—Ä–µ–¥–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ –º–∏—Ä–∞ –∏—Å—Ç–æ—Ä–∏–π, —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –≤ –Ω–∞—à–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ.</p>
        <FormKit type="form" :actions="false" messages-class="hidden" form-class="flex gap-2 items-start">
            <FormKit validation="required" messages-class="text-[#E9556D] font-mono" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ, –∞–≤—Ç–æ—Ä, –∂–∞–Ω—Ä" name="–ü–æ–∏—Å–∫" outer-class="text-[#131313] w-full" input-class="focus:outline-none px-4 py-1.5 bg-white rounded-xl border border-transparent w-full transition-all duration-500 focus:border-amber-500 shadow-md"/>
            <button type="submit" class="cursor-pointer py-1.5 px-4 rounded-xl bg-white w-fit transition-all duration-500 hover:opacity-60 text-[#131313] shadow-[0px_0px_13px_-7px_black]">–ò—Å–∫–∞—Ç—å</button>
        </FormKit>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <NuxtLink to="/" class="bg-white transition-all duration-500 rounded-xl p-4 border border-gray-200 shadow-[0px_0px_13px_-7px_black] hover:shadow-none flex flex-col gap-2">
            <p class="text-3xl">üîç</p>
            <p class="text-xl font-mono font-medium">–ö–∞—Ç–∞–ª–æ–≥</p>
            <p class="text-sm text-gray-500">–í—Å–µ –∫–Ω–∏–≥–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</p>
        </NuxtLink>
        <NuxtLink to="/profile" class="bg-white transition-all duration-500 rounded-xl p-4 border border-gray-200 shadow-[0px_0px_13px_-7px_black] hover:shadow-none flex flex-col gap-2">
            <p class="text-3xl">üë§</p>
            <p class="text-xl font-mono font-medium">–ü—Ä–æ—Ñ–∏–ª—å</p>
            <p class="text-sm text-gray-500">–í–∞—à–∏ –∫–Ω–∏–≥–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>
        </NuxtLink>
    </div>
    <div class="flex flex-col gap-6">
        <p class="mainHeading">üì∞ –ë–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏</p>
        <NuxtLink :to="`/news/new-${ article.id }`" class="flex flex-col gap-4 border-b border-gray-400 p-4 transition-all duration-500 hover:opacity-50" v-for="article in news.slice(0,6)">
            <p class="text-xl font-semibold font-mono">{{ article.title }}</p>
            <p class="text-sm text-gray-500 line-clamp-2">{{ article.content }}</p>
        </NuxtLink>
        <NuxtLink to="/news" class="bg-amber-600 transition-all duration-500 w-fit text-white px-6 py-2 rounded-xl hover:opacity-60 self-end">
            –ï—â—ë –Ω–æ–≤–æ—Å—Ç–∏
        </NuxtLink>
    </div>
    <div class="bg-green-50 p-4 rounded-xl w-full text-center border border-green-200 shadow-sm flex flex-col items-center gap-4">
        <p class="mainHeading">üé≤ –ù–µ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –ø–æ—á–∏—Ç–∞—Ç—å?</p>
        <p>–ü–æ–∑–≤–æ–ª—å—Ç–µ –Ω–∞–º –≤—ã–±—Ä–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å –¥–ª—è –≤–∞—Å</p> <!-- –∏–ª–∏ –∫–Ω–∏–≥—É -->
        <button @click="goToRandomArticle" class="bg-green-600 transition-all duration-500 w-fit text-white px-6 py-2 rounded-xl hover:opacity-60">
            –ö—Ä—É—Ç–∏—Ç—å –±–∞—Ä–∞–±–∞–Ω
        </button>
    </div>
    
</template>

<script setup>
/* –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —è–∑—ã–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
useSeoMeta({
    title: '–ì–ª–∞–≤–Ω–∞—è',
    lang: 'ru'
})


/* –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ë–î –∏ —Ä–æ—É—Ç–µ—Ä–∞ */
const supabase = useSupabaseClient()
const router = useRouter()


/* —Å–ª—É—á–∞–π–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å */
const randomId = ref(null)
const newsLength = ref(null)

const goToRandomArticle = () => {
    randomId.value = Math.floor(Math.random() * (newsLength.value - 1) + 1)
    router.push(`/news/new-${randomId.value}`)
}


/* –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö */
const news = ref([])
const loadNews = async() => {
    const { data, error } = await supabase
    .from('news')
    .select()

    if(data) {
        news.value = data
        newsLength.value = data.length
    }
}


/* –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ */
onMounted(() => {
    loadNews()
})
</script>